<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)--> <!--(Document created with RoboEditor. )============================--> <!--(==============================================================)-->


<!-- Mirrored from www.hgy413.com/hgydocs/IA32/instruct64_hh/fnma_-_floating-point_negative_multiply_add.htm by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 16:55:46 GMT -->
<head>

<title>fnma - 浮点乘法加法取反</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=utf-8">
<meta name=date content="03 16, 2003 1:39:53 PM">
<meta name=topic-status content="In Progress">
<meta name=topic-priority content=0>
<meta name=topic-time-estimate content=0>
<meta name=topic-comment content>
<meta name=topic-id content="fnma - Floating-point Negative Multiply Add">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1016>
<meta name=layout-width content=771>


<!--(Links)=========================================================-->

 <link rel='stylesheet' href='https://www.hgy413.com/hgydocs/IA32/instruct64_hh/MSL_styl_ns.css'>
<script type="text/javascript" language="JavaScript" title="WebHelpSplitCss">
<!--
if (navigator.appName !="Netscape")
{   document.write("<link rel='stylesheet' href='https://www.hgy413.com/hgydocs/IA32/instruct64_hh/MSL_styl.css'>");}
//-->
</script>
<style type="text/css">
<!--
hr.whs1 {width: 75.311%; height: 3px; float: alignleft;}
p.whs2 {font-weight: bold;}
p.whs3 {font-weight: normal;}
hr.whs4 {width: 50%; float: alignleft;}
-->
</style>
<script type="text/javascript" language="JavaScript" title="WebHelpInlineScript">
<!--
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//-->
</script>
<style type="text/css">
<!--
  div.WebHelpPopupMenu {position:absolute; left:0px; top:0px; z-index:4; visibility:hidden;}
-->
</style>
<script type="text/javascript" language="javascript1.2" src="https://www.hgy413.com/hgydocs/IA32/whmsg.js"></script>
<script type="text/javascript" language="javascript" src="https://www.hgy413.com/hgydocs/IA32/whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="https://www.hgy413.com/hgydocs/IA32/whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="https://www.hgy413.com/hgydocs/IA32/whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="https://www.hgy413.com/hgydocs/IA32/whtopic.js"></script>
</head>

<!--(Body)==========================================================-->


<body>

<script type="text/javascript" language="javascript1.2">
<!--
if (window.gbWhTopic)
{
	if (window.addTocInfo)
	{
	addTocInfo("参考\n指令集\n英特尔(R) 安腾(R) 指令\nF - 指令\nfnma - 浮点乘法加法取反");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(0);

	if (window.setRelStartPage)
	{
	setRelStartPage("https://www.hgy413.com/hgydocs/IA32/reference_olh.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();
//-->
</script>
<h1>浮点乘法加法取反</h1>

<p>fnma</p>

<p><span style="font-weight: bold;"><B>格式</B></span> </p>

<p><span class=Code>(qp) fnma.pc.sf f1 = f3, f4, f2 F1</span></p>


<!--(HR)============================================================-->
<hr width="75.311%" size="3" align="left" class="whs1">


<p class="whs2">说明</p>

<p>FR f3 与 FR f4 的乘积计算到无限精度，取反之后加上 FR f2，同样计算到无限精度。随后按照 FPSR.sf.rc 指定的取整模式，将结果值取整到 pc（及可能的 FPSR.sf.pc 与 FPSR.sf.wre）指定的精度。取整后的结果放入 FR f1。</p>

<p>如果 FR f3、FR f4 或 FR f2 中的任何一个是 NaTVal，则 FR f1 设置为 NaTVal，而不是计算的结果。</p>

<p>如果 f2 是 f0，则执行 IEEE 乘法运算，然后对乘积取反。请参阅</p>

<p>第 3:82 页上的&ldquo;fnmpy - 浮点乘法取反&rdquo;。</p>

<p>操作码的 pc 的助记符值在第 3:50 页上的&ldquo;表 2-22&rdquo;中给出。sf 的助记符值在第 3:50 页上的&ldquo;表 2-23&rdquo;中给出。如需了解状态字段的 pc、wre 及 rc 的编码与解释，请参阅 <span style="font-style: italic;"><I>Intel(R) Itanium(R) Architecture Software Developer's Manual</I></span>（英特尔(R) 安腾(R) 体系结构软件开发人员手册）第 1:80 页的&ldquo;表 5-5&rdquo;与&ldquo;表 5-6&rdquo;。 </p>


<!--(HR)============================================================-->
<hr width="75.311%" size="3" align="left" class="whs1">


<p class="whs2">操作 </p>

<p class="whs3">if (PR[qp]) {</p>

<p>fp_check_target_register(f1);</p>

<p>if (tmp_isrcode = fp_reg_disabled(f1, f2, f3, f4))</p>

<p>disabled_fp_register_fault(tmp_isrcode, 0);</p>

<p>if (fp_is_natval(FR[f2]) || fp_is_natval(FR[f3]) ||</p>

<p>fp_is_natval(FR[f4])) {</p>

<p>FR[f1] = NATVAL;</p>

<p>fp_update_psr(f1);</p>

<p>} else {</p>

<p>tmp_default_result = fms_fnma_exception_fault_check(f2, f3, f4,</p>

<p>pc, sf, &amp;tmp_fp_env);</p>

<p>if (fp_raise_fault(tmp_fp_env))</p>

<p>fp_exception_fault(fp_decode_fault(tmp_fp_env));</p>

<p>if (fp_is_nan_or_inf(tmp_default_result)) {</p>

<p>FR[f1] = tmp_default_result;</p>

<p>} else {</p>

<p>tmp_res = fp_mul(fp_reg_read(FR[f3]), fp_reg_read(FR[f4]));</p>

<p>tmp_res.sign = !tmp_res.sign;</p>

<p>if (f2 != 0)</p>

<p>tmp_res = fp_add(tmp_res, fp_reg_read(FR[f2]), tmp_fp_env);</p>

<p>FR[f1] = fp_ieee_round(tmp_res, &amp;tmp_fp_env);</p>

<p>}</p>

<p>fp_update_fpsr(sf, tmp_fp_env);</p>

<p>fp_update_psr(f1);</p>

<p>if (fp_raise_traps(tmp_fp_env))</p>

<p>fp_exception_trap(fp_decode_trap(tmp_fp_env));</p>

<p>}</p>

<p>}</p>


<!--(HR)============================================================-->
<hr width="50%" align="left" class="whs4">


<p class="whs2">FP 异常</p>

<p>无效操作 (V) 下溢 (U)</p>

<p>非规格化/非常规操作数 (D) 上溢 (O)</p>

<p>软件协助 (SWA) 错误：不精确 (I)</p>

<p>软件协助 (SWA) 陷阱</p>

<p>中断：禁用&ldquo;浮点寄存器&rdquo;错误与&ldquo;浮点异常&rdquo;陷阱</p>

<p>&ldquo;浮点异常&rdquo;错误</p>

<script type="text/javascript" language="javascript1.2">
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);
//-->
</script>
</body>


<!-- Mirrored from www.hgy413.com/hgydocs/IA32/instruct64_hh/fnma_-_floating-point_negative_multiply_add.htm by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 16:55:46 GMT -->
</html>
